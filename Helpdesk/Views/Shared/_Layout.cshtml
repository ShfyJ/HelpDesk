@using ITHelpDesk.Utility
@using ITHelpDesk.Models
@using HelpDesk.DataAccess.Data
@using Microsoft.AspNetCore.Identity
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager
@inject ApplicationDbContext _db


@{ 
    var userId = UserManager.GetUserId(User);
    var user = _db.User.FirstOrDefault(u => u.Id == userId);

    var roleId = _db.UserRoles.FirstOrDefault(u => u.UserId == userId).RoleId;
    var role = _db.Roles.FirstOrDefault(u => u.Id == roleId).Name;
    user.Role = role;
 }

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>@ViewData["Title"] - HelpDesk</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="~/css/site.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" />
    <link href="~/notifications/ikr.notification.css" rel="stylesheet" />
    <link href="~/assets/main.css" rel="stylesheet">
    <link href="~/register/style.css" rel="stylesheet">
    <link rel="stylesheet" href="~/register/css/responsive.css">
    <link rel="stylesheet" href="~/register/css/jquery.dataTables.min.css">


    <!-- font awesome CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/font-awesome.min.css">
    <!-- owl.carousel CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/owl.carousel.css">
    <link rel="stylesheet" href="~/register/css/owl.theme.css">
    <link rel="stylesheet" href="~/register/css/owl.transitions.css">
    <!-- meanmenu CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/meanmenu/meanmenu.min.css">
    <!-- animate CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/animate.css">
    <!-- normalize CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/normalize.css">
    <!-- wave CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/wave/waves.min.css">
    <link rel="stylesheet" href="~/register/css/wave/button.css">
    <!-- mCustomScrollbar CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/scrollbar/jquery.mCustomScrollbar.min.css">
    <!-- Notika icon CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/notika-custom-icon.css">
    <link rel="stylesheet" href="~/register/css/main.css">
    <!-- style CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/style.css">

    <!-- dialog CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/dialog/sweetalert2.min.css">
    <link rel="stylesheet" href="~/register/css/dialog/dialog.css">
    <!-- responsive CSS
        ============================================ -->
    <link rel="stylesheet" href="~/register/css/responsive.css">
    <!-- modernizr JS
       ============================================ -->

</head>
<body>
    <div class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header">
        <header>
            <div class="app-header header-shadow">
                <div class="app-header__logo">
                    <div class="logo-src"></div>
                    <div class="header__pane ml-auto">
                        <div>
                            <button type="button" class="hamburger close-sidebar-btn hamburger--elastic" data-class="closed-sidebar">
                                <span class="hamburger-box">
                                    <span class="hamburger-inner"></span>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="app-header__mobile-menu">
                    <div>
                        <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
                <div class="app-header__menu">
                    <span>
                        <button type="button" class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
                            <span class="btn-icon-wrapper">
                                <i class="fa fa-ellipsis-v fa-w-6"></i>
                            </span>
                        </button>
                    </span>
                </div>    <div class="app-header__content">
                    <div class="app-header-left">
                        <div class="search-wrapper">
                            <div class="input-holder">
                                <input type="text" class="search-input" placeholder="Type to search">
                                <button class="search-icon"><span></span></button>
                            </div>
                            <button class="close"></button>
                        </div>
                        <ul class="header-menu nav">
                            <li class="nav-item">
                                <a href="javascript:void(0);" class="nav-link">
                                    <i class="nav-link-icon fa fa-database"> </i>
                                    Statistics
                                </a>
                            </li>
                            <li class="btn-group nav-item">
                                <a href="javascript:void(0);" class="nav-link">
                                    <i class="nav-link-icon fa fa-edit"></i>
                                    Projects
                                </a>
                            </li>
                            <li class="dropdown nav-item">
                                <a href="javascript:void(0);" class="nav-link">
                                    <i class="nav-link-icon fa fa-cog"></i>
                                    Settings
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="app-header-right">
                        <div class="header-btn-lg pr-0">
                            <div class="widget-content p-0">
                                <div class="widget-content-wrapper">
                                    <partial name="_LoginPartial" />
                                    @if (SignInManager.IsSignedIn(User))
                                    {
                                        <div class="widget-content-left  ml-3 header-user-info">
                                            <div class="widget-heading">
                                                @user.Fullname
                                            </div>
                                            <div class="widget-subheading">
                                                @user.Role
                                            </div>
                                        </div>

                                    }

                                    <div class="widget-content-right header-user-info ml-3">
                                        <button type="button" class="btn-shadow p-1 btn btn-primary btn-sm show-toastr-example">
                                            <i class="fa text-white fa-calendar pr-1 pl-1"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="app-main">
            <div class="app-sidebar sidebar-shadow">
                <div class="app-header__logo">
                    <div class="logo-src" src="assets/images/Helpdesk(4).png"></div>
                    <div class="header__pane ml-auto">
                        <div>
                            <button type="button" class="hamburger close-sidebar-btn hamburger--elastic" data-class="closed-sidebar">
                                <span class="hamburger-box">
                                    <span class="hamburger-inner"></span>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="app-header__mobile-menu">
                    <div>
                        <button type="button" class="hamburger hamburger--elastic mobile-toggle-nav">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
                <div class="app-header__menu">
                    <span>
                        <button type="button" class="btn-icon btn-icon-only btn btn-primary btn-sm mobile-toggle-header-nav">
                            <span class="btn-icon-wrapper">
                                <i class="fa fa-ellipsis-v fa-w-6"></i>
                            </span>
                        </button>
                    </span>
                </div>


                <div class="scrollbar-sidebar">
                    <div class="app-sidebar__inner">
                        <ul class="vertical-nav-menu metismenu">
                            @if (User.IsInRole(SD.Role_Admin))
                            {
                                <li class="app-sidebar__heading">Admin Control</li>
                                <li>
                                    <a asp-area="Admin" asp-controller="Users" asp-action="index">
                                        <i class="metismenu-icon pe-7s-rocket"></i>
                                        Users List
                                    </a>
                                </li>
                                <li>
                                    <a asp-area="Admin" asp-controller="Address" asp-action="index">
                                        <i class="metismenu-icon pe-7s-rocket"></i>
                                        Address List
                                    </a>
                                </li>
                            }

                            @if (User.IsInRole(SD.Role_HeadManager))
                            {
                                <li class="app-sidebar__heading">Headmanager Control</li>
                                <li>
                                    <a asp-area="HeadManager" asp-controller="Requests" asp-action="dashboard">
                                        <i class="metismenu-icon pe-7s-diamond"></i>
                                        Analytics
                                    </a>
                                </li>

                                <li>
                                    <a asp-area="HeadManager" asp-controller="Requests" asp-action="requests">
                                        <i class="metismenu-icon pe-7s-mail-open-file"></i>
                                        Requests
                                    </a>
                                    <ul>
                                        <li>
                                            <a asp-area="HeadManager" asp-controller="Requests" asp-action="newrequests">
                                                <i class="metismenu-icon pe-7s-albums"></i>
                                                New Requests
                                            </a>
                                        </li>
                                        <li>
                                            <a asp-area="HeadManager" asp-controller="Requests" asp-action="requestsinprogress">
                                                <i class="metismenu-icon pe-7s-albums"></i>
                                                Requests in Progress
                                            </a>
                                        </li>
                                        <li>
                                            <a asp-area="HeadManager" asp-controller="Requests" asp-action="newrequestsuncompleted">
                                                <i class="metismenu-icon pe-7s-albums"></i>
                                                Requests Uncompleted
                                            </a>
                                        </li>
                                        <li>
                                            <a asp-area="HeadManager" asp-controller="Requests" asp-action="newrequestscompleted">
                                                <i class="metismenu-icon pe-7s-albums"></i>
                                                Requests Completed
                                            </a>
                                        </li>
                                    </ul>

                                </li>

                                <li>
                                    <a asp-area="HeadManager" asp-controller="Workers" asp-action="contacts">
                                        <i class="metismenu-icon pe-7s-id"></i>
                                        Employee Contact
                                    </a>
                                </li>


                            }

                            @if (User.IsInRole(SD.Role_Manager))
                            {
                                <li class="app-sidebar__heading">Manager Control</li>
                                <li>
                                    <a asp-area="Manager" asp-controller="RequestManager" asp-action="dashboard">
                                        <i class="metismenu-icon pe-7s-diamond"></i>
                                        Analytics
                                    </a>
                                </li>

                                <li>
                                    <a asp-area="Manager" asp-controller="RequestManager" asp-action="Index">
                                        <i class="metismenu-icon pe-7s-mail-open-file"></i>
                                        Requests
                                    </a>
                                    <ul>
                                        <li>
                                            <a asp-area="Manager" asp-controller="RequestManager" asp-action="Index">
                                                <i class="metismenu-icon pe-7s-albums"></i>
                                                New Requests
                                            </a>
                                        </li>
                                        <li>
                                            <a asp-area="Manager" asp-controller="Requests" asp-action="requestsinprogress">
                                                <i class="metismenu-icon pe-7s-albums"></i>
                                                Requests in Progress
                                            </a>
                                        </li>
                                        <li>
                                            <a asp-area="Manager" asp-controller="Requests" asp-action="newrequestsuncompleted">
                                                <i class="metismenu-icon pe-7s-albums"></i>
                                                Requests Uncompleted
                                            </a>
                                        </li>
                                        <li>
                                            <a asp-area="Manager" asp-controller="Requests" asp-action="newrequestscompleted">
                                                <i class="metismenu-icon pe-7s-albums"></i>
                                                Requests Completed
                                            </a>
                                        </li>
                                    </ul>

                                </li>

                                <li>
                                    <a asp-area="Manager" asp-controller="Workers" asp-action="contacts">
                                        <i class="metismenu-icon pe-7s-id"></i>
                                        Employee Contact
                                    </a>
                                </li>


                            }


                            @*<li class="app-sidebar__heading">UI Components</li>
                                <li>
                                    <a href="#">
                                        <i class="metismenu-icon pe-7s-diamond"></i>
                                        Elements
                                        <i class="metismenu-state-icon pe-7s-angle-down caret-left"></i>
                                    </a>
                                    <ul>
                                        <li>
                                            <a href="elements-buttons-standard.html">
                                                <i class="metismenu-icon"></i>
                                                Buttons
                                            </a>
                                        </li>
                                        <li>
                                            <a href="elements-dropdowns.html">
                                                <i class="metismenu-icon">
                                                </i>Dropdowns
                                            </a>
                                        </li>
                                        <li>
                                            <a href="elements-icons.html">
                                                <i class="metismenu-icon">
                                                </i>Icons
                                            </a>
                                        </li>
                                        <li>
                                            <a href="elements-badges-labels.html">
                                                <i class="metismenu-icon">
                                                </i>Badges
                                            </a>
                                        </li>
                                        <li>
                                            <a href="elements-cards.html">
                                                <i class="metismenu-icon">
                                                </i>Cards
                                            </a>
                                        </li>
                                        <li>
                                            <a href="elements-list-group.html">
                                                <i class="metismenu-icon">
                                                </i>List Groups
                                            </a>
                                        </li>
                                        <li>
                                            <a href="elements-navigation.html">
                                                <i class="metismenu-icon">
                                                </i>Navigation Menus
                                            </a>
                                        </li>
                                        <li>
                                            <a href="elements-utilities.html">
                                                <i class="metismenu-icon">
                                                </i>Utilities
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#">
                                        <i class="metismenu-icon pe-7s-car"></i>
                                        Components
                                        <i class="metismenu-state-icon pe-7s-angle-down caret-left"></i>
                                    </a>
                                    <ul>
                                        <li>
                                            <a href="components-tabs.html">
                                                <i class="metismenu-icon">
                                                </i>Tabs
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-accordions.html">
                                                <i class="metismenu-icon">
                                                </i>Accordions
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-notifications.html">
                                                <i class="metismenu-icon">
                                                </i>Notifications
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-modals.html">
                                                <i class="metismenu-icon">
                                                </i>Modals
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-progress-bar.html">
                                                <i class="metismenu-icon">
                                                </i>Progress Bar
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-tooltips-popovers.html">
                                                <i class="metismenu-icon">
                                                </i>Tooltips &amp; Popovers
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-carousel.html">
                                                <i class="metismenu-icon">
                                                </i>Carousel
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-calendar.html">
                                                <i class="metismenu-icon">
                                                </i>Calendar
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-pagination.html">
                                                <i class="metismenu-icon">
                                                </i>Pagination
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-scrollable-elements.html">
                                                <i class="metismenu-icon">
                                                </i>Scrollable
                                            </a>
                                        </li>
                                        <li>
                                            <a href="components-maps.html">
                                                <i class="metismenu-icon">
                                                </i>Maps
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="tables-regular.html">
                                        <i class="metismenu-icon pe-7s-display2"></i>
                                        Tables
                                    </a>
                                </li>
                                <li class="app-sidebar__heading">Widgets</li>
                                <li>
                                    <a href="dashboard-boxes.html">
                                        <i class="metismenu-icon pe-7s-display2"></i>
                                        Dashboard Boxes
                                    </a>
                                </li>
                                <li class="app-sidebar__heading">Forms</li>
                                <li>
                                    <a href="forms-controls.html">
                                        <i class="metismenu-icon pe-7s-mouse">
                                        </i>Forms Controls
                                    </a>
                                </li>
                                <li>
                                    <a href="forms-layouts.html">
                                        <i class="metismenu-icon pe-7s-eyedropper">
                                        </i>Forms Layouts
                                    </a>
                                </li>
                                <li>
                                    <a href="forms-validation.html">
                                        <i class="metismenu-icon pe-7s-pendrive">
                                        </i>Forms Validation
                                    </a>
                                </li>
                                <li class="app-sidebar__heading">Charts</li>
                                <li>
                                    <a href="charts-chartjs.html">
                                        <i class="metismenu-icon pe-7s-graph2">
                                        </i>ChartJS
                                    </a>
                                </li>*@


                        </ul>
                    </div>
                </div>


            </div>
            <div class="app-main__outer">
                <div class="app-main__inner">
                    @RenderBody()
                </div>
            </div>
        </div>


        <div class="footer-copyright-area">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="footer-copy-right">
                            <p>
                                Copyright © 2020 UNG Helpdesk
                                . All rights reserved.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="~/assets/scripts/main.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://kit.fontawesome.com/c36730de28.js" crossorigin="anonymous"></script>
    <script src="~/register/js/vendor/modernizr-2.8.3.min.js"></script>

    <script src="~/notifications/ikr.notificationPlugin.js"></script>

    <script src="~/push/push.js"></script>

    <!-- jquery
        ============================================ -->
    <!-- bootstrap JS
        ============================================ -->
    <script src="~/register/js/bootstrap.min.js"></script>
    <!-- wow JS
        ============================================ -->
    <script src="~/register/js/wow.min.js"></script>
    <!-- price-slider JS
        ============================================ -->
    <script src="~/register/js/jquery-price-slider.js"></script>
    <!-- owl.carousel JS
        ============================================ -->
    <script src="~/register/js/owl.carousel.min.js"></script>
    <!-- scrollUp JS
        ============================================ -->
    <script src="~/register/js/jquery.scrollUp.min.js"></script>
    <!-- meanmenu JS
        ============================================ -->
    <script src="~/register/js/meanmenu/jquery.meanmenu.js"></script>
    <!-- counterup JS
        ============================================ -->
    <script src="~/register/js/counterup/jquery.counterup.min.js"></script>
    <script src="~/register/js/counterup/waypoints.min.js"></script>
    <script src="~/register/js/counterup/counterup-active.js"></script>
    <!-- mCustomScrollbar JS
        ============================================ -->
    <script src="~/register/js/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
    <!-- sparkline JS
        ============================================ -->
    <script src="~/register/js/sparkline/jquery.sparkline.min.js"></script>
    <script src="~/register/js/sparkline/sparkline-active.js"></script>
    <!-- flot JS
        ============================================ -->
    <script src="~/register/js/flot/jquery.flot.js"></script>
    <script src="~/register/js/flot/jquery.flot.resize.js"></script>
    <script src="~/register/js/flot/flot-active.js"></script>
    <!-- knob JS
        ============================================ -->
    <script src="~/register/js/knob/jquery.knob.js"></script>
    <script src="~/register/js/knob/jquery.appear.js"></script>
    <script src="~/register/js/knob/knob-active.js"></script>
    <!--  wave JS
        ============================================ -->
    <script src="~/register/js/wave/waves.min.js"></script>
    <script src="~/register/js/wave/wave-active.js"></script>
    <!--  Chat JS
        ============================================ -->
    <script src="~/register/js/chat/jquery.chat.js"></script>
    <!--  todo JS
        ============================================ -->
    <script src="~/register/js/todo/jquery.todo.js"></script>
    <!-- plugins JS
        ============================================ -->
    <script src="~/register/js/plugins.js"></script>
    <!-- main JS
        ============================================ -->
    <script src="~/register/js/main.js"></script>
    <!--
    ============================================ -->
    <script src="~/register/js/dialog/sweetalert2.min.js"></script>
    <script src="~/register/js/dialog/dialog-active.js"></script>
    <!-- tawk chat JS
        ============================================ -->
    @*<script src="~/register/js/tawk-chat.js"></script>*@


    @RenderSection("Scripts", required: false)
</body>
</html>


<script type="text/javascript">
    $(document).ready(function () {
        $("#noti_Container").ikrNotificationSetup();
        function autoref() {
            $.ajax({
                type: "GET",
                dataType: "json",
                url: "/Manager/RequestManager/GetNotifications",
                traditional: true,
                contentType: "application/json;charset=utf-8",
                success: function (data) {
                    console.log(data);

                    var notifications = data;


                    //  var prevId = notifications[1].requestId;
                    // console.log(prevId);
                    $("#noti_Container").ikrNotificationCount({
                        NotificationList: notifications,
                        ListTitlePropName: "rName",
                        // ListBodyPropName: "room",
                        ActionName: "AllNotifications"
                    });

                },
                error: function (xhr, status, error) {

                }
            });

            setTimeout(autoref, 1000);

        }
        setTimeout(autoref, 1000);

    });

 //clickable row function here

   //jQuery(document).ready(function ($) {
   //     $(".clickable-row").click(function () {
   //         window.location = $(this).data("href");
   //     });
   // });


</script>

